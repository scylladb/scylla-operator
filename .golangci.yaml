version: "2"
linters:
  default: none
  enable:
    - unused
    - govet
    - importas
    - ginkgolinter
    # More linters can be added, see supported ones: https://golangci-lint.run/usage/linters/
  exclusions:
    presets:
      - common-false-positives
      - std-error-handling
    rules:
      # TODO: https://github.com/scylladb/scylla-operator/issues/3190
      - path: test/e2e/
        linters:
          - ginkgolinter
        text: "use BeforeEach\\(\\) to assign variable"
  settings:
    importas:
      no-unaliased: true
      alias:
        # # e.g. k8s.io/api/core/v1 -> corev1
        - pkg: k8s.io/api/(\w+)/(v[\w\d]+)
          alias: ${1}${2}
        # e.g. github.com/scylladb/scylla-operator/pkg/api/scylla/v1alpha1 -> scyllav1alpha1
        - pkg: github.com/scylladb/scylla-operator/pkg/api/(\w+)/(v\d+[\w\d]*)
          alias: ${1}${2}
        # e.g. k8s.io/apimachinery/pkg/util/errors -> apimachineryutilerrors
        - pkg: k8s.io/apimachinery/pkg/util/(\w+)
          alias: apimachineryutil${1}
        - pkg: k8s.io/apimachinery/pkg/apis/meta/v1
          alias: metav1
        - pkg: k8s.io/apimachinery/pkg/apis/meta/v1/validation
          alias: metav1validation
        - pkg: github.com/scylladb/scylla-operator/pkg/helpers/slices
          alias: oslices
        - pkg: github.com/prometheus-operator/prometheus-operator/pkg/apis/monitoring/v1
          alias: monitoringv1
    ginkgolinter:
      forbid-spec-pollution: true
      forbid-focus-container: true
      validate-async-intervals: true
formatters:
  enable:
    - gofmt
    - goimports
    - gci
run:
  build-tags:
    - envtest
