apiVersion: v1
kind: Namespace
metadata:
  name: example-manager

---
apiVersion: scylla.scylladb.com/v1
kind: ScyllaCluster
metadata:
  name: scylla-manager-cluster
  namespace: example-manager
  labels:
    scylla-manager-cluster: "true"

spec:
  version: 4.6.3
  agentVersion: 3.0.0
  repository: docker.io/scylladb/scylla
  agentRepository: docker.io/scylladb/scylla-manager-agent
  developerMode: true
  cpuset: false
  datacenter:
    name: manager-dc
    racks:
      - name: manager-rack
        members: 1
        storage:
          capacity: 1Gi
        resources:
          limits:
            cpu: 250m
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 100Mi

---
apiVersion: scylla.scylladb.com/v1alpha1
kind: ScyllaManager
metadata:
  name: scylla-manager
  namespace: example-manager
spec:
  replicas: 1
  image: docker.io/scylladb/scylla-manager:3.0.0
  scyllaClusterSelector:
    matchLabels:
      example-manager: "true"
      managed: "true"
      managed-by: scylla-manager

  database:
    connection:
      server: scylla-manager-cluster-manager-dc-manager-rack-0.example-manager.svc
      username: cassandra
      password: cassandra

  repairs:
    - name: repair-task
      intensity: "0"
      timezone: UTC
      numRetries: 0
      cron: "@every 2m"

---
apiVersion: scylla.scylladb.com/v1
kind: ScyllaCluster
metadata:
  labels:
    example-manager: "true"
    managed: "true"
    managed-by: scylla-manager
  name: simple-cluster
  namespace: example-manager
spec:
  sysctls:
    - "fs.aio-max-nr=2097152"
  version: 4.6.3
  agentVersion: 3.0.0
  repository: docker.io/scylladb/scylla
  agentRepository: docker.io/scylladb/scylla-manager-agent
  developerMode: true
  datacenter:
    name: us-east-1
    racks:
      - name: us-east-1a
        members: 1
        storage:
          capacity: 1Gi
        resources:
          requests:
            cpu: 1
            memory: 1Gi
          limits:
            cpu: 1
            memory: 1Gi
        volumes:
          - name: coredumpfs
            hostPath:
              path: /tmp/coredumps
        volumeMounts:
          - mountPath: /tmp/coredumps
            name: coredumpfs
